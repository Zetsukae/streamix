<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Bienvenue sur Streamix</title>
  <style>
    /* --- STYLE GITHUB DARK & ROUNDED --- */
    :root {
      --bg-canvas: #0d1117;       /* Fond principal */
      --bg-surface: #161b22;      /* Fond panneau */
      --border-color: #30363d;    /* Bordures */
      --text-main: #c9d1d9;       /* Texte blanc cassé */
      --text-muted: #8b949e;      /* Texte gris */
      --btn-bg: #21262d;
      --error-color: #f85149;
      --link-color: #58a6ff;
    }

    /* SCROLLBAR INVISIBLE */
    ::-webkit-scrollbar { display: none; }
    * { scrollbar-width: none; }

    body {
      margin: 0; padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      background-color: var(--bg-canvas);
      color: var(--text-main);
      height: 100vh;
      display: flex; justify-content: center; align-items: center;
      user-select: none;
      -webkit-app-region: drag; /* La fenêtre se déplace en la prenant n'importe où */
    }

    .setup-container {
      background-color: var(--bg-surface);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 40px;
      width: 420px;
      text-align: center;
      box-shadow: 0 8px 24px rgba(0,0,0,0.4);
      -webkit-app-region: no-drag; /* Zone cliquable */
    }

    .logo { width: 64px; height: 64px; margin-bottom: 24px; opacity: 0.9; }

    h1 { font-size: 20px; font-weight: 600; margin: 0 0 12px 0; color: var(--text-main); }

    p { color: var(--text-muted); font-size: 14px; margin-bottom: 24px; line-height: 1.5; }

    .input-group { position: relative; margin-bottom: 24px; text-align: left; }

    label { display: block; font-size: 12px; font-weight: 600; margin-bottom: 6px; color: var(--text-main); }

    input[type="text"] {
      width: 100%; padding: 10px 12px; background-color: var(--bg-canvas);
      border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-main);
      font-size: 14px; box-sizing: border-box; transition: 0.2s; outline: none; font-family: monospace;
    }
    input[type="text"]:focus { border-color: var(--link-color); box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15); }
    input[type="text"].error { border-color: var(--error-color); box-shadow: 0 0 0 3px rgba(248, 81, 73, 0.15); }

    .error-msg {
      color: var(--error-color); font-size: 12px; margin-top: 6px; display: none;
    }

    .btn-launch {
      width: 100%; padding: 10px; background-color: #238636; color: white;
      border: 1px solid rgba(240, 246, 252, 0.1); border-radius: 6px;
      font-size: 14px; font-weight: 600; cursor: pointer; transition: background 0.2s;
    }
    .btn-launch:hover { background-color: #2ea043; }

    .shake { animation: shake 0.5s; }
    @keyframes shake {
      0% { transform: translateX(0); } 25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0); }
    }

    .footer-links { margin-top: 24px; font-size: 12px; color: var(--text-muted); }
    .link { color: var(--link-color); text-decoration: none; cursor: pointer; margin-left: 4px; }
    .link:hover { text-decoration: underline; }
  </style>
</head>
<body>

  <div class="setup-container">
    <img src="https://i.imgur.com/lv3zp1J.png" alt="Logo Streamix" class="logo">

    <h1>Configuration initiale</h1>
    <p>Veuillez entrer une URL de source valide (hébergée sur GitHub Pages) pour synchroniser votre contenu.</p>

    <div class="input-group">
      <label>URL de la source</label>
      <input type="text" id="urlInput" placeholder="https://pseudo.github.io/projet/">
      <div class="error-msg" id="errorMsg">Source invalide (doit contenir .github.io/)</div>
    </div>

    <button id="launchBtn" class="btn-launch">Lancer Streamix</button>

    <div class="footer-links">
      Pas de source ?
      <a id="findSourceLink" class="link">Trouver des sources</a>
    </div>
  </div>

  <script>
    const urlInput = document.getElementById('urlInput');
    const launchBtn = document.getElementById('launchBtn');
    const errorMsg = document.getElementById('errorMsg');

    launchBtn.addEventListener('click', () => {
      const url = urlInput.value.trim();

      // VALIDATION STRICTE : Uniquement .github.io/
      if(url.length > 0 && url.includes(".github.io/")) {
        const finalUrl = url.startsWith('http') ? url : 'https://' + url;
        window.electronAPI.saveConfig({ sourceUrl: finalUrl });
      } else {
        urlInput.classList.add('error');
        errorMsg.style.display = 'block';
        launchBtn.classList.add('shake');
        setTimeout(() => launchBtn.classList.remove('shake'), 500);
      }
    });

    urlInput.addEventListener('input', () => {
       urlInput.classList.remove('error');
       errorMsg.style.display = 'none';
    });

    urlInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') launchBtn.click();
    });

    // LIEN VERS LES SOURCES (streamix.buzz)
    document.getElementById('findSourceLink').addEventListener('click', () => {
      window.electronAPI.openExternal('https://streamix.buzz/sources/');
    });
  </script>
</body>
</html>
